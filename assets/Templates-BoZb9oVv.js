import{r as o,j as e}from"./ui-Cg0tFRDi.js";import{n as P,o as S}from"./index-D-kChlQ_.js";import"./vendor-Bzgz95E1.js";import"./firebase-DCRhkHpN.js";const g=n=>{if(!n)return"";const d=n.match(/\/file\/d\/([a-zA-Z0-9_-]+)\//);return d?`https://lh3.googleusercontent.com/d/${d[1]}`:n},z=({setModal:n,user:d})=>{const[x,b]=o.useState([]),[f,p]=o.useState(!0),[m,y]=o.useState(""),[r,j]=o.useState("All"),[s,c]=o.useState(null),l=d,h=async()=>{p(!0);try{const t=await P();b(t)}catch(t){console.error(t)}finally{p(!1)}},N=()=>{h()};o.useEffect(()=>{h()},[]);const v=["All","Slides","Docs","Free","Pro"],u=o.useMemo(()=>{const t=m.toLowerCase();return x.filter(a=>r==="All"?!0:["Slides","Docs"].includes(r)?a.type===r:["Free","Pro"].includes(r)?a.plan===r:!0).filter(a=>a.name.toLowerCase().includes(t)||a.description.toLowerCase().includes(t))},[x,m,r]),w=(t,a)=>{navigator.clipboard.writeText(t).then(()=>{const i=a.innerHTML;a.disabled=!0,a.innerHTML='<span class="material-icons-outlined text-xl">check</span> Copied!',setTimeout(()=>{a.innerHTML=i,a.disabled=!1},2e3)}).catch(i=>{console.error("Failed to copy: ",i),alert("Failed to copy ID.")})},k=t=>{n({type:"confirmation",props:{title:"Delete Template",message:`Are you sure you want to delete the template <strong>${t.name}</strong>? This action cannot be undone.`,onConfirm:async()=>{try{await S(t.id),N()}catch(a){alert(`Error: ${a.message}`)}n({type:null,props:{}})}}})},T={Sheet:"grid_on",Slides:"slideshow",Docs:"article"},C={Sheet:"text-green-500",Slides:"text-yellow-500",Docs:"text-blue-500"};return e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx("span",{className:"material-icons-outlined text-blue-600 dark:text-blue-500",children:"description"}),"Templates"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1 text-base",children:'Click a template to preview and copy its ID for use in the "Marge It" page.'})]}),e.jsx("div",{className:"card p-4 mb-8 sticky top-0 z-10 backdrop-blur-sm bg-white/80 dark:bg-slate-900/80",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"input-with-icon flex-grow",children:[e.jsx("span",{className:"material-icons-outlined input-icon text-gray-400",children:"search"}),e.jsx("input",{type:"text",placeholder:"Search templates...",value:m,onChange:t=>y(t.target.value),"aria-label":"Search templates"})]}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2 -mb-2",role:"tablist","aria-label":"Template Filters",children:v.map(t=>e.jsx("button",{onClick:()=>j(t),className:`px-4 py-2 text-sm font-semibold rounded-full whitespace-nowrap transition-colors ${r===t?"bg-blue-600 text-white":"bg-gray-100 dark:bg-slate-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-700"}`,role:"tab","aria-selected":r===t,children:t},t))})]})}),f?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"spinner"})}):e.jsx(e.Fragment,{children:u.length===0?e.jsxs("div",{className:"text-center py-16 text-gray-500 dark:text-gray-400",children:[e.jsx("p",{className:"text-2xl font-bold",children:"No templates found."}),e.jsx("p",{className:"mt-2",children:"Try adjusting your search or filter."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:u.map(t=>{const a=(l==null?void 0:l.role)==="Admin",i=g(t.imageUrl||"")||"https://via.placeholder.com/400x225.png/F1F5F9/94A3B8?text=No+Preview";return e.jsxs("div",{className:"group relative card flex flex-col overflow-hidden cursor-pointer transition-all duration-300 hover:shadow-lg hover:-translate-y-1",title:t.name,children:[a&&e.jsx("button",{onClick:I=>{I.stopPropagation(),k(t)},className:"absolute top-2 right-2 z-20 p-1.5 bg-red-500/80 hover:bg-red-600 text-white rounded-full shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-200",title:"Delete Template","aria-label":`Delete ${t.name}`,children:e.jsx("span",{className:"material-icons-outlined text-base",children:"delete"})}),e.jsxs("div",{className:"relative aspect-video bg-gray-100 dark:bg-slate-800 overflow-hidden",onClick:()=>c({src:i,src2:g(t.imageUrl2||""),template:t,currentIndex:0}),children:[e.jsx("img",{src:i,alt:t.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-300 flex items-center justify-center",children:e.jsx("span",{className:"material-icons-outlined text-white text-4xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 drop-shadow-lg",children:"zoom_in"})}),e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-bold shadow-md ${t.plan==="Pro"?"bg-yellow-400 text-yellow-900":"bg-blue-500 text-white"}`,children:[t.plan==="Pro"&&e.jsx("span",{className:"material-icons-outlined text-sm",children:"workspace_premium"}),t.plan]})})]}),e.jsxs("div",{className:"p-4 flex-grow flex flex-col",children:[e.jsx("h3",{className:"font-bold truncate text-base",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex-grow",children:[t.description.substring(0,70)||"No description available.","..."]})]})]},t.id)})})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",onClick:()=>c(null),role:"dialog","aria-modal":"true","aria-labelledby":"template-modal-title",children:e.jsxs("div",{className:"card w-full max-w-5xl max-h-[90vh] flex flex-col md:flex-row overflow-hidden shadow-2xl",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{className:"absolute top-3 right-3 z-10 p-1.5 bg-gray-100/50 hover:bg-gray-200/80 dark:bg-gray-800/50 dark:hover:bg-gray-700/80 rounded-full cursor-pointer transition-colors",onClick:()=>c(null),title:"Close","aria-label":"Close modal",children:e.jsx("span",{className:"material-icons-outlined",children:"close"})}),e.jsxs("div",{className:"md:w-3/5 overflow-hidden flex items-center justify-center bg-gray-100 dark:bg-slate-900/50 p-4 relative",children:[s.src2&&s.src2!==""&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"absolute left-4 top-1/2 -translate-y-1/2 z-10 p-2 bg-black/50 hover:bg-black/70 text-white rounded-full transition-colors",onClick:t=>{t.stopPropagation(),c(a=>a?{...a,currentIndex:(a.currentIndex-1+2)%2}:null)},title:"Previous Image","aria-label":"Previous Image",children:e.jsx("span",{className:"material-icons-outlined",children:"chevron_left"})}),e.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 z-10 p-2 bg-black/50 hover:bg-black/70 text-white rounded-full transition-colors",onClick:t=>{t.stopPropagation(),c(a=>a?{...a,currentIndex:(a.currentIndex+1)%2}:null)},title:"Next Image","aria-label":"Next Image",children:e.jsx("span",{className:"material-icons-outlined",children:"chevron_right"})})]}),e.jsx("img",{src:s.currentIndex===0?s.src:s.src2||s.src,alt:s.template.name,className:"max-w-full max-h-[50vh] md:max-h-[85vh] object-contain rounded-lg"})]}),e.jsxs("div",{className:"md:w-2/5 p-8 flex flex-col",children:[e.jsxs("div",{children:[e.jsx("h3",{id:"template-modal-title",className:"text-2xl font-bold mb-3",children:s.template.name}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 text-base",children:s.template.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`material-icons-outlined ${C[s.template.type]}`,children:T[s.template.type]})," ",s.template.type]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`material-icons-outlined ${s.template.plan==="Pro"?"text-yellow-500":"text-blue-500"}`,children:s.template.plan==="Pro"?"workspace_premium":"check_circle"})," ",s.template.plan]})]}),s.template.plan==="Pro"&&!(l!=null&&l.hasProAccess)&&e.jsxs("div",{className:"mt-6 p-3 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 rounded-lg text-sm font-semibold flex items-center gap-2",children:[e.jsx("span",{className:"material-icons-outlined",children:"lock"}),"Pro Access Required to use this template."]})]}),e.jsxs("div",{className:"space-y-3 mt-auto pt-6",children:[e.jsxs("button",{className:"btn btn-primary w-full",onClick:t=>w(s.template.id,t.currentTarget),disabled:s.template.plan==="Pro"&&!(l!=null&&l.hasProAccess),children:[e.jsx("span",{className:"material-icons-outlined",children:"content_copy"}),"Copy Template ID"]}),e.jsxs("a",{href:`https://docs.google.com/presentation/d/${s.template.id}/`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-secondary w-full",children:[e.jsx("span",{className:"material-icons-outlined",children:"open_in_new"}),"View Template"]}),s.template.sheetUrl&&e.jsxs("a",{href:s.template.sheetUrl,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline w-full",children:[e.jsx("span",{className:"material-icons-outlined",children:"table_chart"}),"View Sheet"]})]})]})]})})]})};export{z as default};
