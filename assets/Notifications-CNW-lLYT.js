import{r as n,j as e}from"./ui-Cg0tFRDi.js";import{s as N,M as f,m as j}from"./index-DTZyYScH.js";import"./vendor-Bzgz95E1.js";import"./firebase-DCRhkHpN.js";const v=({onNotificationSent:o})=>{const[s,l]=n.useState({title:"",description:"",category:"System",priority:"Medium",icon:"info",iconColor:"text-blue-500"}),[c,u]=n.useState(!1),d=[{value:"info",label:"Info",color:"text-blue-500"},{value:"campaign",label:"Announcement",color:"text-purple-500"},{value:"warning",label:"Warning",color:"text-yellow-500"},{value:"error",label:"Error",color:"text-red-500"},{value:"check_circle",label:"Success",color:"text-green-500"},{value:"build",label:"Maintenance",color:"text-orange-500"}],x=async a=>{if(a.preventDefault(),!(!s.title||!s.description)){u(!0);try{await j({id:`admin_${Date.now()}`,icon:s.icon,iconColor:s.iconColor,title:s.title,description:s.description,timestamp:new Date().toLocaleString(),isNew:!0,priority:s.priority,category:s.category}),l({title:"",description:"",category:"System",priority:"Medium",icon:"info",iconColor:"text-blue-500"}),o(),window.showToast&&window.showToast({type:"success",title:"Notification Sent",message:"Notification has been sent to all users.",duration:3e3})}catch(i){console.error("Failed to send notification:",i),window.showToast&&window.showToast({type:"error",title:"Failed to Send",message:"Could not send notification. Please try again.",duration:3e3})}finally{u(!1)}}};return e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:s.title,onChange:a=>l(i=>({...i,title:a.target.value})),placeholder:"Notification title",className:"w-full p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),e.jsxs("select",{value:s.category,onChange:a=>l(i=>({...i,category:a.target.value})),className:"w-full p-2",children:[e.jsx("option",{value:"System",children:"System"}),e.jsx("option",{value:"Update",children:"Update"}),e.jsx("option",{value:"Alert",children:"Alert"}),e.jsx("option",{value:"Info",children:"Info"}),e.jsx("option",{value:"Billing",children:"Billing"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description *"}),e.jsx("textarea",{value:s.description,onChange:a=>l(i=>({...i,description:a.target.value})),placeholder:"Notification message",className:"w-full p-2 h-20",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Priority"}),e.jsxs("select",{value:s.priority,onChange:a=>l(i=>({...i,priority:a.target.value})),className:"w-full p-2",children:[e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Icon"}),e.jsx("select",{value:s.icon,onChange:a=>{const i=d.find(m=>m.value===a.target.value);l(m=>({...m,icon:a.target.value,iconColor:(i==null?void 0:i.color)||"text-blue-500"}))},className:"w-full p-2",children:d.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]}),e.jsx("button",{type:"submit",disabled:c||!s.title||!s.description,className:"btn btn-primary",children:c?"Sending...":"Send Notification"})]})},A=({navigateTo:o,user:s})=>{const[l,c]=n.useState([]),[u,d]=n.useState(!0),[x,a]=n.useState("All"),[i,m]=n.useState(!1);n.useEffect(()=>{(async()=>{d(!0);try{const r=await N();c(r)}catch(r){console.error("Failed to fetch notifications",r),c(f.map(h=>({...h,id:String(Math.random())})))}finally{d(!1)}})()},[]);const p=()=>{c(t=>t.map(r=>({...r,isNew:!1}))),window.showToast&&window.showToast({type:"info",title:"All Read",message:"All notifications have been marked as read.",duration:2e3})},g=l.filter(t=>i&&!t.isNew?!1:x==="All"?!0:t.category===x),b=["All",...Array.from(new Set(l.map(t=>t.category)))];return e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx("span",{className:"material-icons-outlined text-blue-600 dark:text-blue-500",children:"notifications"}),"Notifications"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1 text-base",children:"Manage your notifications and stay updated."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"card p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("div",{className:"flex gap-2 flex-wrap",children:b.map(t=>e.jsx("button",{onClick:()=>a(t),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${x===t?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:t},t))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m(!i),className:`btn ${i?"btn-primary":"btn-secondary"} text-sm`,children:i?"Show All":"New Only"}),e.jsx("button",{onClick:p,className:"btn btn-secondary text-sm",children:"Mark All Read"})]})]})}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-6 border-b border-inherit",children:[e.jsx("h2",{className:"text-xl font-bold",children:"All Notifications"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Your notification history and updates."})]}),e.jsx("div",{className:"divide-y divide-inherit",children:u?e.jsx("div",{className:"p-8 text-center",children:e.jsx("div",{className:"spinner mx-auto"})}):g.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"material-icons-outlined text-4xl mb-2 opacity-50",children:"notifications_none"}),e.jsx("p",{children:"No notifications found."})]}):g.map((t,r)=>e.jsx("div",{className:`p-4 hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors ${t.isNew?"bg-blue-50 dark:bg-blue-900/20":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:`material-icons-outlined ${t.iconColor} text-xl mt-0.5`,children:t.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-sm",children:t.title}),t.isNew&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-0.5 rounded-full dark:bg-blue-900 dark:text-blue-300",children:"New"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t.priority==="High"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300":t.priority==="Medium"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:t.priority})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:t.timestamp}),e.jsx("span",{className:"bg-gray-100 text-gray-600 px-2 py-1 rounded dark:bg-gray-700 dark:text-gray-300",children:t.category})]}),t.actions&&t.actions.length>0&&e.jsx("div",{className:"flex gap-2 mt-3",children:t.actions.map((h,y)=>e.jsx("button",{onClick:()=>{o&&o(h.url)},className:`text-xs px-3 py-1 rounded ${h.type==="primary"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:h.text},y))})]})]})},t.id||r))})]})]}),e.jsxs("div",{className:"space-y-6",children:[(s==null?void 0:s.role)==="Admin"&&e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Send Notification"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Send notifications to all users."}),e.jsx(v,{onNotificationSent:()=>window.location.reload()})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Quick Stats"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Total Notifications"}),e.jsx("span",{className:"font-semibold",children:l.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Unread"}),e.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:l.filter(t=>t.isNew).length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"High Priority"}),e.jsx("span",{className:"font-semibold text-red-600 dark:text-red-400",children:l.filter(t=>t.priority==="High").length})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Notification Preferences"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Manage your notification settings."}),e.jsxs("button",{onClick:()=>o&&o("settings"),className:"btn btn-secondary w-full",children:[e.jsx("span",{className:"material-icons-outlined text-sm",children:"settings"}),"Go to Settings"]})]})]})]})]})};export{A as default};
